{"cells": [{"cell_type": "markdown", "metadata": {}, "source": "# Loan Approval Prediction \u2013 End-to-End Machine Learning Project"}, {"cell_type": "markdown", "metadata": {}, "source": "## 1. Project Overview\nThis project demonstrates a complete ML workflow including EDA, data cleaning, visualization, feature engineering, and model building."}, {"cell_type": "markdown", "metadata": {}, "source": "## 2. Import Required Libraries"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns"}, {"cell_type": "markdown", "metadata": {}, "source": "## 3. Load Dataset"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "df = pd.read_csv('loanapproval.csv')\ndf.head()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 4. Dataset Shape"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "df.shape"}, {"cell_type": "markdown", "metadata": {}, "source": "## 5. Dataset Information"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "df.info()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 6. Statistical Summary"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "df.describe()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 7. Check Missing Values"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "df.isnull().sum()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 8. Visualize Missing Values"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "sns.heatmap(df.isnull(), cbar=False)\nplt.show()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 9. Fill Missing Values (Numerical)"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "num_cols = df.select_dtypes(include=np.number).columns\ndf[num_cols] = df[num_cols].fillna(df[num_cols].median())"}, {"cell_type": "markdown", "metadata": {}, "source": "## 10. Fill Missing Values (Categorical)"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "cat_cols = df.select_dtypes(include='object').columns\ndf[cat_cols] = df[cat_cols].fillna(df[cat_cols].mode().iloc[0])"}, {"cell_type": "markdown", "metadata": {}, "source": "## 11. Verify Missing Values After Treatment"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "df.isnull().sum()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 12. Target Variable Distribution"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "sns.countplot(x='Loan_Status', data=df)\nplt.show()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 13. Gender vs Loan Status"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "sns.countplot(x='Gender', hue='Loan_Status', data=df)\nplt.show()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 14. Education vs Loan Status"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "sns.countplot(x='Education', hue='Loan_Status', data=df)\nplt.show()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 15. Correlation Matrix"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "plt.figure(figsize=(10,6))\nsns.heatmap(df.corr(numeric_only=True), annot=True)\nplt.show()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 16. Encode Categorical Variables"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nfor col in cat_cols:\n    df[col] = le.fit_transform(df[col])"}, {"cell_type": "markdown", "metadata": {}, "source": "## 17. Features and Target Split"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "X = df.drop('Loan_Status', axis=1)\ny = df['Loan_Status']"}, {"cell_type": "markdown", "metadata": {}, "source": "## 18. Train-Test Split"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 19. Feature Scaling"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 20. Logistic Regression Model"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.linear_model import LogisticRegression\nlr = LogisticRegression()\nlr.fit(X_train, y_train)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 21. Logistic Regression Accuracy"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "lr.score(X_test, y_test)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 22. Decision Tree Classifier"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.tree import DecisionTreeClassifier\ndt = DecisionTreeClassifier(random_state=42)\ndt.fit(X_train, y_train)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 23. Decision Tree Accuracy"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "dt.score(X_test, y_test)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 24. Random Forest Classifier"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier(n_estimators=200, random_state=42)\nrf.fit(X_train, y_train)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 25. Random Forest Accuracy"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "rf.score(X_test, y_test)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 26. Predictions"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "y_pred = rf.predict(X_test)\ny_pred[:10]"}, {"cell_type": "markdown", "metadata": {}, "source": "## 27. Confusion Matrix"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.metrics import confusion_matrix\nconfusion_matrix(y_test, y_pred)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 28. Classification Report"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.metrics import classification_report\nprint(classification_report(y_test, y_pred))"}, {"cell_type": "markdown", "metadata": {}, "source": "## 29. Cross Validation"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.model_selection import cross_val_score\ncv = cross_val_score(rf, X, y, cv=5)\ncv.mean()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 30. Feature Importance"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "pd.Series(rf.feature_importances_, index=X.columns).sort_values(ascending=False)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 31. Visualize Feature Importance"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "pd.Series(rf.feature_importances_, index=X.columns).plot(kind='bar')\nplt.show()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 32. ROC Curve"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.metrics import roc_curve, auc\ny_prob = rf.predict_proba(X_test)[:,1]\nfpr, tpr, _ = roc_curve(y_test, y_prob)\nplt.plot(fpr, tpr)\nplt.show()"}, {"cell_type": "markdown", "metadata": {}, "source": "## 33. Model Comparison Summary"}, {"cell_type": "markdown", "metadata": {}, "source": "- Logistic Regression\n- Decision Tree\n- Random Forest (Best)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 34. Hyperparameter Tuning (Optional)"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "from sklearn.model_selection import GridSearchCV\nparams = {'n_estimators':[100,200],'max_depth':[5,10,None]}\ngrid = GridSearchCV(rf, params, cv=3)\ngrid.fit(X_train, y_train)"}, {"cell_type": "markdown", "metadata": {}, "source": "## 35. Best Parameters"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "grid.best_params_"}, {"cell_type": "markdown", "metadata": {}, "source": "## 36. Final Model Accuracy"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "grid.best_score_"}, {"cell_type": "markdown", "metadata": {}, "source": "## 37. Save Model"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "import joblib\njoblib.dump(rf, 'loan_model.pkl')"}, {"cell_type": "markdown", "metadata": {}, "source": "## 38. Load Model"}, {"cell_type": "code", "execution_count": null, "metadata": {}, "outputs": [], "source": "joblib.load('loan_model.pkl')"}, {"cell_type": "markdown", "metadata": {}, "source": "## 39. Final Conclusion"}, {"cell_type": "markdown", "metadata": {}, "source": "Random Forest performed best with high accuracy and generalization."}, {"cell_type": "markdown", "metadata": {}, "source": "## 40. End of Project"}], "metadata": {"kernelspec": {"display_name": "Python 3", "language": "python", "name": "python3"}}, "nbformat": 4, "nbformat_minor": 5}